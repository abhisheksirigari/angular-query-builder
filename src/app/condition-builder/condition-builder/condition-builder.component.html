<div class="modal-header">
  <h4 class="modal-title">Condition builder for success</h4>
  <button type="button" class="close" aria-label="Close" (click)="onCancel()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body">

  <div class="row">
    <div class="col-12">
      <div class="logical-exp">
        <app-query [query]="query"></app-query>
      </div>
      <!-- <div class="form-group">
        <label for="logicalexpressionInput">logical expression</label>
        <textarea class="output">{{query | json}}</textarea>
      </div> -->
    </div>
  </div>

  <div ngNoForm>
    <query-builder id="triggerQuery" 
    [(ngModel)]="query" [config]="config"
    [allowRuleset]="allowRuleset" [allowCollapse]="allowCollapse">
      <ng-container
        *queryButtonGroup="let ruleset; let addRule=addRule; let addRuleSet=addRuleSet; let removeRuleSet=removeRuleSet">
        <div class="btn-group" style="margin-left: 50px;">
          <button class="btn btn-outline-primary btn-sm" (click)="addRule()">Add condition</button>
          <button class="btn btn-outline-primary btn-sm" (click)="addRuleSet()">Add Group</button>
          <button class="btn btn-outline-primary btn-sm" (click)="removeRuleSet()" *ngIf="removeRuleSet">
            Delete</button>
        </div>
      </ng-container>
      <ng-container *queryRemoveButton="let rule; let removeRule=removeRule"> 
        <button class="btn btn-outline-primary btn-sm" (click)="$event.preventDefault();removeRule(rule)">
          <i class="fa fa-trash" aria-hidden="true"></i></button>        
      </ng-container>

      <ng-container *queryField="let rule; let fields=fields; let changeField=changeField">
        <select id="alertMetaSelection" class="form-control" [(ngModel)]="rule.field"
          (input)="onQueryChanged($event, rule)" required>
          <option *ngFor="let field of fields" [ngValue]="field.value">
            {{field.name}}
          </option>
        </select>
      </ng-container>

      <ng-container *queryField="let rule; let fields=fields; let changeField=changeField">
        <select id="alertMetaSelection" class="form-control" [(ngModel)]="rule.field"
          (input)="onQueryChanged($event, rule)" required>
          <option *ngFor="let field of fields" [ngValue]="field.value">
            {{field.name}}
          </option>
        </select>
      </ng-container>

      <ng-container *queryOperator="let rule; let operators=operators">
        <select id="alertOperatorSelection" class="form-control" [(ngModel)]="rule.operator"
          (input)="onQueryChanged($event, rule)" required>
          <option *ngFor="let value of operators" [ngValue]="value">
            {{value}}
          </option>
        </select>
      </ng-container>

      <ng-container *queryInput="let rule; type: 'string'">
        <input type="text" id="alertValue" class="form-control" [(ngModel)]="rule.value"
          (input)="onQueryChanged($event, rule)" required>
      </ng-container>

      
    </query-builder>



    <!-- <query-builder [(ngModel)]='query' [config]='currentConfig' [allowRuleset]='allowRuleset'
      [allowCollapse]='allowCollapse'>
      <ng-container
        *queryButtonGroup="let ruleset; let addRule=addRule; let addRuleSet=addRuleSet; let removeRuleSet=removeRuleSet">
        <button type="button" class="btn btn-outline-primary btn-sm" (click)="addRule()">
          Add condition</button>
        <button type="button" class="btn btn-outline-primary btn-sm" *ngIf="addRuleSet" (click)="addRuleSet()">
          Add Group
        </button>
        <button type="button" class="btn btn-outline-primary btn-sm" *ngIf="removeRuleSet" (click)="removeRuleSet()">
          Delete
        </button>
      </ng-container>
      <ng-container *queryArrowIcon>
        <i class="fa fa-arrow-right"></i>
      </ng-container>
    </query-builder> -->
  </div>

</div>
<div class="modal-footer">
  <button type="button" class="btn btn-secondary" (click)="onConfirm()">Save</button>
  <button type="button" class="btn btn-secondary" (click)="onCancel()">Cancel</button>
</div>